<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>    
<%= javascript_include_tag "jxs" %> 

<script type="text/javascript">   
		<!-- 
			var mapa; 	// obiekt globalny
			var dymek; 	// okno z informacjami
						
			function mapaStart()  
			{  
				var wspolrzedne = new google.maps.LatLng(50.10625672736391, 18.972363958613595);
				var opcjeMapy = {
					zoom: 19,
					center: wspolrzedne,
					mapTypeId: google.maps.MapTypeId.SATELLITE,
				};
				mapa = new google.maps.Map(document.getElementById("map"), opcjeMapy); 			
				dymek = new google.maps.InfoWindow();
				
				wczytajMarkery();

			}  
			
			function wczytajMarkery()
			{
				jx.load('feed.xml', function(xml)
				{
					var markery = xml.getElementsByTagName("marker");
					for(var i=0; i<markery.length; i++)
					{
						var lat			=	parseFloat(markery[i].attributes.getNamedItem("lat").nodeValue);
						var lon			=	parseFloat(markery[i].attributes.getNamedItem("lon").nodeValue);
						var nazwa		=	markery[i].attributes.getNamedItem("nazwa").nodeValue;     
						var ikona_url	=	markery[i].attributes.getNamedItem("ikona").nodeValue;
						var opis		=	markery[i].attributes.getNamedItem("opis").nodeValue;
						var tytul		=	markery[i].attributes.getNamedItem("tytul").nodeValue;  
						var marker		=	dodajMarker(lat,lon,ikona_url,nazwa,opis,tytul);
					}
				},'xml','get');
			}
				
			function dodajMarker(lat,lon,ikona_url,nazwa,opis,tytul)
			{   
				var rozmiar = new google.maps.Size(35,35);   
                var punkt_startowy = new google.maps.Point(0,0);   
                var punkt_zaczepienia = new google.maps.Point(17,17);
                var ikona = new google.maps.MarkerImage(ikona_url, rozmiar, punkt_startowy, punkt_zaczepienia);

				var marker	=	new google.maps.Marker(
					{
						position: new google.maps.LatLng(lat,lon),
						title: nazwa, 
						icon: ikona,
						map: mapa
					}
				);
				marker.txt	=	'<strong>'+nazwa+'</strong><br/>'+tytul+'<br/>'+opis+'';
				
				google.maps.event.addListener(marker,"click",function()
				{
					dymek.setPosition(marker.getPosition());
					dymek.setContent(marker.txt);
					dymek.open(mapa);
				});
				return marker;
			}
		-->
		</script>
		
	   		<div id="map">
			</div>  
			
			<script type="text/javascript">
			mapaStart();
			</script>
